<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#0B2C5F" />
    <title>Admin Dashboard | Contract Marketing Hub</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0B2C5F',
                        darkbg: '#081A33',
                        accent: '#F59E0B'
                    }
                }
            }
        };
    </script>

    <style>
        html,
        body {
            overflow-x: hidden;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col bg-gradient-to-b from-darkbg to-primary text-gray-100">

    <!-- ================= NAVBAR ================= -->
    <header class="fixed top-0 left-0 w-full z-50 bg-darkbg shadow-md">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <h1 class="font-bold text-lg">Admin Dashboard</h1>

                <!-- DESKTOP NAV -->
                <nav class="hidden md:flex items-center gap-6 text-sm">
                    <a href="/admin/dashboard.html">Dashboard</a>
                    <a href="/admin/users.html">Users</a>
                    <a href="/admin/contracts-pending.html">Pending Contracts</a>
                    <a href="/admin/active-contracts.html">Active Contracts</a>
                    <a href="/admin/completed-contracts.html">Completed Contracts</a>
                    <a href="/admin/email-verification.html">Email Verifications</a>
                    <a href="/admin/withdrawal.html">Withdrawals</a>
                    <a href="/admin/payment-settings.html">Payment Settings</a>
                    <button id="logoutBtnDesktop" class="text-red-400 ml-4">Logout</button>
                </nav>

                <!-- MOBILE MENU BUTTON -->
                <button id="menuBtn" class="md:hidden flex flex-col gap-1.5">
                    <span class="w-6 h-0.5 bg-accent"></span>
                    <span class="w-6 h-0.5 bg-accent"></span>
                    <span class="w-6 h-0.5 bg-accent"></span>
                </button>
            </div>
        </div>
    </header>

    <!-- MOBILE MENU OVERLAY -->
    <div id="menuOverlay" class="fixed inset-0 bg-black/50 hidden z-40"></div>

    <!-- MOBILE MENU PANEL -->
    <div id="mobileMenu" class="fixed top-0 right-0 h-full w-72 bg-darkbg text-white
        translate-x-full transition-transform duration-300 z-50">

        <div class="p-6 space-y-6 text-sm">
            <button id="closeMenu" class="text-right w-full text-xl text-accent font-bold">
                ✕
            </button>

            <a href="dashboard.html" class="block text-accent">Dashboard</a>
            <a href="users.html" class="block">Users</a>
            <a href="contracts-pending.html" class="block">Pending Contracts</a>
            <a href="active-contracts.html" class="block">Active Contracts</a>
            <a href="completed-contracts.html" class="block">Completed Contracts</a>
            <a href="email-verification.html" class="block">Email Verifications</a>
            <a href="withdrawal.html" class="block">Withdrawals</a>
            <a href="payment-settings.html" class="block">Payment Settings</a>

            <button id="logoutBtnMobile" class="block mt-6 px-4 py-3 bg-red-500/10 text-red-400 rounded-lg text-left">
                Logout
            </button>
        </div>
    </div>

    <!-- ================= MAIN ================= -->
    <main class="flex-1 max-w-7xl mx-auto px-4 pt-28 pb-8 w-full">

        <section class="mb-6">
            <h2 class="text-2xl font-semibold">Overview</h2>
            <p class="text-sm text-gray-300">Administrative summary and controls</p>
        </section>

        <!-- STATS -->
        <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-10">
            <div class="bg-white text-gray-800 rounded-xl p-5 shadow">
                <p class="text-sm text-gray-500">Total Users</p>
                <p id="totalUsers" class="text-2xl font-bold">—</p>
            </div>

            <div class="bg-white text-gray-800 rounded-xl p-5 shadow">
                <p class="text-sm text-gray-500">Total Contracts</p>
                <p id="totalContracts" class="text-2xl font-bold">—</p>
            </div>

            <div class="bg-white text-gray-800 rounded-xl p-5 shadow">
                <p class="text-sm text-gray-500">Pending Withdrawals</p>
                <p id="pendingWithdrawals" class="text-2xl font-bold text-yellow-600">—</p>
            </div>

            <div class="bg-white text-gray-800 rounded-xl p-5 shadow">
                <p class="text-sm text-gray-500">Approved (Unpaid)</p>
                <p id="approvedWithdrawals" class="text-2xl font-bold text-primary">—</p>
            </div>
        </section>

        <!-- QUICK ACTIONS -->
        <section class="grid grid-cols-1 md:grid-cols-4 gap-6">

            <div class="bg-white text-gray-800 rounded-xl p-6 shadow">
                <h3 class="font-semibold mb-2">Pending Contracts</h3>
                <p class="text-sm text-gray-600 mb-4">
                    Review payments and approve or reject contracts.
                </p>
                <a href="contracts-pending.html"
                    class="inline-block px-4 py-2 bg-primary text-white rounded-lg text-sm">
                    Review →
                </a>
            </div>

            <div class="bg-white text-gray-800 rounded-xl p-6 shadow">
                <h3 class="font-semibold mb-2">Active Contracts</h3>
                <p class="text-sm text-gray-600 mb-4">
                    View running contracts.
                </p>
                <a href="active-contracts.html" class="inline-block px-4 py-2 bg-primary text-white rounded-lg text-sm">
                    View →
                </a>
            </div>

            <div class="bg-white text-gray-800 rounded-xl p-6 shadow">
                <h3 class="font-semibold mb-2">Completed Contracts</h3>
                <p class="text-sm text-gray-600 mb-4">
                    View finished and credited contracts.
                </p>
                <a href="completed-contracts.html"
                    class="inline-block px-4 py-2 bg-primary text-white rounded-lg text-sm">
                    View →
                </a>
            </div>

            <div class="bg-white text-gray-800 rounded-xl p-6 shadow">
                <h3 class="font-semibold mb-2">Withdrawals</h3>
                <p class="text-sm text-gray-600 mb-4">
                    Review and manage withdrawals.
                </p>
                <a href="withdrawal.html" class="inline-block px-4 py-2 bg-primary text-white rounded-lg text-sm">
                    Manage →
                </a>
            </div>

        </section>
    </main>

    <!-- ================= FOOTER ================= -->
    <footer class="border-t border-white/10 text-center py-4 text-sm text-gray-300">
        © <span id="year"></span> Contract Marketing Hub
    </footer>

    <!-- ================= LOGIC ================= -->
    <script>
        document.getElementById('year').textContent = new Date().getFullYear();

        const token = localStorage.getItem('token');


        if (!token) {
            localStorage.clear();
            window.location.href = '../auth/login.html';
        }
        async function loadAdminStats() {
            try {
                const res = await fetch('/api/admin/stats', {
                    headers: {
                        Authorization: 'Bearer ' + token
                    }
                });

                const data = await res.json();

                totalUsers.textContent = data.totalUsers ?? '0';
                totalContracts.textContent = data.totalContracts ?? '0';
                pendingWithdrawals.textContent = data.pendingWithdrawals ?? '0';
                approvedWithdrawals.textContent = data.approvedWithdrawals ?? '0';

            } catch (err) {
                console.error('Failed to load admin stats');
            }
        }

        loadAdminStats();

        const menuBtn = document.getElementById('menuBtn');
        const closeMenu = document.getElementById('closeMenu');
        const mobileMenu = document.getElementById('mobileMenu');
        const menuOverlay = document.getElementById('menuOverlay');

        menuBtn.onclick = () => {
            mobileMenu.classList.remove('translate-x-full');
            menuOverlay.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        };

        function closeMobileMenu() {
            mobileMenu.classList.add('translate-x-full');
            menuOverlay.classList.add('hidden');
            document.body.style.overflow = '';
        }

        closeMenu.onclick = closeMobileMenu;
        menuOverlay.onclick = closeMobileMenu;

        const logout = () => {
            localStorage.clear();
            location.href = '/auth/login.html';
        };

        document.getElementById('logoutBtnDesktop').onclick = logout;
        document.getElementById('logoutBtnMobile').onclick = logout;
    </script>

</body>

</html>